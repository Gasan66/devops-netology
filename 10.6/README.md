# 10.06. Инцидент-менеджмент

| **Пункт**                  | **Описание**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Краткое описание инцидента | В следствии кратковременной потери связи между датацентрами произошла рассинхронизация данных.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Предшествующие события     | Плановые ремонтные работы по замене неисправного оптического оборудования 100G.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Причина инцидента          | Перенастройка геокластера в топологию, которую не поддерживали приложения.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Воздействие                | Инцидент затронул не всю платформу, а только несколько внутренних систем, что привело к отображению устаревшей и непоследовательной информации.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Обнаружение                | Внутренние системы мониторинга начали генерировать оповещения, указывающие на многочисленные сбои в работе систем.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Реакция                    | Группа реагирования вручную заблокировала средства развертывания для предотвращения изменения топологии.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Восстановление             | Был приостановлен сервис. Далее были подняты бэкапы обоих сайтов для восстановления стабильной топологии. Затем провели работы по устранению несогласованности.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Таймлайн                   | **21.10.2018, 22:52 UTC**<br/>Перестройка кластера из за сбоя сети<br/>**21.10.2018, 22:54 UTC**<br/>Сработка мониторинга<br/>**21.10.2018, 23:07 UTC**<br/>Блокировка внутренних средств развертывания<br/>**21.10.2018, 23:13 UTC**<br/>Принято решение о применении "failing-forward"<br/>**22.10.2018, 00:05 UTC**<br/>Принято решение о восстановлении системы из бэкапа<br/>**22.10.2018, 00:41 UTC**<br/>Инициирован процесс резервного копирования для всех затронутых кластеров MySQL<br/>**22.10.2018, 11:12 UTC**<br/>Все первичные БД вновь переведены на Восток<br/>**22.10.2018, 16:24 UTC**<br/>Синхронизировались все реплики<br/>**22.10.2018, 23:03 UTC**<br/>Все незавершённые события вебхуков и сборки Pages обработаны, а целостность и правильная работа всех систем подтверждена. |
| Последующие действия       | 1. Отрегулировать конфигурацию Orchestrator, чтобы запретить перемещение первичных БД за границы региона.<br/>2. Новая система отчётности по статусам.<br/>3. Применение инструментов хаос-инжиниринга.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |